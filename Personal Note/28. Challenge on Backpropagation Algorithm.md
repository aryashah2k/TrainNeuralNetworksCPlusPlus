Challenge: Write your own backpropagation function

Ready to finish up your multi-layer perceptron, class? This time your task is to write a backpropagation trainer function, which will run one sample through the network with the backpropagation algorithm. Don't worry, you'll just have to write a few lines per step in the provided code. You'll simply have to fill in the blanks. You can do this, and feel free to go back to the backpropagation videos if you get stuck. 

The function is called BP and it starts at line 80. It receives a feature vector X and a label vector Y. I've placed a comment for each step and skeleton code for the loops. Now, for steps three and four, you'll need a vector of vectors, I added to the class to store the error terms or lowercase deltas. That's why I named it lowercase D. You may want to check the constructor code at mlp.h and look for this vector. You'll see that it has the same organization as the values vector. So it's created and initialized right next to it. So this D vector holds the error term for each neuron just like the values vector holds their output values. 

Back to the backpropagation method, it must return the mean squared error because we'll need it in the training process. Speaking of training, let's go to neuralnetworks.cpp. At the end, starting at line 40, I have including this training example. I'm running the BP function once for each case in the XOR truth table. And that's my whole dataset, just four samples. I'm running it for 3,000 epochs. And I'm calculating the mean of the four errors in an epoch. 

Notice that I'm only printing this error every 100 epochs. So what I'm expecting to see 30 error values in the terminal to keep it simple. I'm also printing out the weights for you to see what the neural network finally came up with. And lastly, we print the truth table. So when you're ready to test your backpropagation function you should see the error drop as the training advances. You'll see the final weights. 

And finally, the four cases will be tested. So you'll know how your training function is doing. This may take you awhile, anything between 30 and 45 minutes, so have fun.